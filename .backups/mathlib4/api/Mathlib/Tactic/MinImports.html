<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Mathlib.Tactic.MinImports</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Mathlib.Tactic.MinImports";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">MinImports</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init.html">Init</a></li><li><a href="../.././ImportGraph/Imports/Redundant.html">ImportGraph.Imports.Redundant</a></li><li><a href="../.././ImportGraph/Imports/RequiredModules.html">ImportGraph.Imports.RequiredModules</a></li><li><a href="../.././Lean/Elab/DeclModifiers.html">Lean.Elab.DeclModifiers</a></li><li><a href="../.././Lean/Elab/DefView.html">Lean.Elab.DefView</a></li><li><a href="../.././Lean/Util/CollectAxioms.html">Lean.Util.CollectAxioms</a></li><li><a href="../.././Mathlib/Tactic/Linter/Header.html">Mathlib.Tactic.Linter.Header</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Mathlib.Tactic.MinImports" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getSyntaxNodeKinds"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getSyntaxNodeKinds</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getVisited"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getVisited</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getId"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getId</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getIds"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getIds</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getAttrNames"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAttrNames</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getAttrs"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAttrs</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.previousInstName"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">previousInstName</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getDeclName"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getDeclName</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getAllDependencies"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAllDependencies</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getAllImports"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAllImports</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.getIrredundantImports"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getIrredundantImports</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.minImpsCore"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">minImpsCore</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.minImpsStx"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">minImpsStx</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Command.MinImports.Â«command#min_importsIn_Â»"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">Â«command#min_importsIn_Â»</span></a></div></nav><main>
<div class="mod_doc"><h1 id="min-imports-in-a-command-to-find-minimal-imports" class="markdown-heading"><code>#min_imports in</code> a command to find minimal imports <a class="hover-link" href="#min-imports-in-a-command-to-find-minimal-imports">#</a></h1><p><code>#min_imports in stx</code> scans the syntax <code>stx</code> to find a collection of minimal imports that should be
sufficient for <code>stx</code> to make sense.
If <code>stx</code> is a command, then it also elaborates <code>stx</code> and, in case it is a declaration, then
it also finds the imports implied by the declaration.</p><p>Unlike the related <code>#find_home</code>, this command takes into account notation and tactic information.</p><h2 id="Limitations" class="markdown-heading">Limitations <a class="hover-link" href="#Limitations">#</a></h2><p>Parsing of <code>attribute</code>s is hard and the command makes minimal effort to support them.
Here is an example where the command fails to notice a dependency:</p><pre><code class="language-lean">import <a href="../.././Mathlib/Data/Sym/Sym2/Init.html">Mathlib.Data.Sym.Sym2.Init</a> -- the actual minimal import
import Aesop.Frontend.Attribute   -- the import that `#min_imports in` suggests

import <a href="../.././Mathlib/Tactic/MinImports.html">Mathlib.Tactic.MinImports</a>

-- import Aesop.Frontend.Attribute
#min_imports in
@[aesop (rule_sets := [Sym2]) [safe [constructors, cases], norm]]
inductive <a href="../.././Mathlib/Data/Rel.html#Rel">Rel</a> (Î± : Type) : Î± Ã— Î± â†’ Î± Ã— Î± â†’ Prop
  | <a href="../.././Mathlib/Order/Defs/Unbundled.html#refl">refl</a> (x y : Î±) : <a href="../.././Mathlib/Data/Rel.html#Rel">Rel</a> _ (x, y) (x, y)
  | swap (x y : Î±) : <a href="../.././Mathlib/Data/Rel.html#Rel">Rel</a> _ (x, y) (y, x)

-- `import Mathlib.Data.Sym.Sym2.Init` is not detected by `#min_imports in`.
</code></pre><h2 id="Todo" class="markdown-heading">Todo <a class="hover-link" href="#Todo">#</a></h2><p><em>Examples</em>
When parsing an <code>example</code>, <code>#min_imports in</code> retrieves all the information that it can from the
<code>Syntax</code> of the <code>example</code>, but, since the <code>example</code> is not added to the environment, it fails
to retrieve any <code>Expr</code> information about the proof term.
It would be desirable to make <code>#min_imports in example ...</code> inspect the resulting proof and
report imports, but this feature is missing for the moment.</p><p><em>Using <code>InfoTrees</code></em>
It may be more efficient (not necessarily in terms of speed, but of simplicity of code),
to inspect the <code>InfoTrees</code> for each command and retrieve information from there.
I have not looked into this yet.</p></div><div class="decl" id="Mathlib.Command.MinImports.getSyntaxNodeKinds"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L67-L74">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getSyntaxNodeKinds" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getSyntaxNodeKinds"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getSyntaxNodeKinds</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Syntax</span> â†’ <span class="fn">Lean.NameSet</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getSyntaxNodeKinds">getSyntaxNodeKinds</a> stx</code> takes a <code>Syntax</code> input <code>stx</code> and returns the <code>NameSet</code> of all the
<code>SyntaxNodeKinds</code> and all the identifiers contained in <code>stx</code>.</p></div></div><div class="decl" id="Mathlib.Command.MinImports.getVisited"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L76-L82">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getVisited" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getVisited"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getVisited</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn">Lean.Name</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Lean.NameSet</span></span></div></div><p>Extracts the names of the declarations in <code>env</code> on which <code>decl</code> depends.</p><details id="instances-for-list-Mathlib.Command.MinImports.getVisited" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getId"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L84-L99">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getId" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getId"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getId</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Lean.Syntax</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getId">getId</a> stx</code> takes as input a <code>Syntax</code> <code>stx</code>.
If <code>stx</code> contains a <code>declId</code>, then it returns the <code>ident</code>-syntax for the <code>declId</code>.
If <code>stx</code> is a nameless instance, then it also tries to fetch the <code>ident</code> for the instance.
Otherwise it returns <code>.missing</code>.</p><details id="instances-for-list-Mathlib.Command.MinImports.getId" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getIds"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L101-L106">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getIds" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getIds"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getIds</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Syntax</span> â†’ <span class="fn">Lean.NameSet</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getIds">getIds</a> stx</code> extracts all identifiers, collecting them in a <code>NameSet</code>.</p></div></div><div class="decl" id="Mathlib.Command.MinImports.getAttrNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L108-L114">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getAttrNames" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAttrNames"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAttrNames</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">Lean.NameSet</span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAttrNames">getAttrNames</a> stx</code> extracts <code>attribute</code>s from <code>stx</code>.
It does not collect <code>simp</code>, <code>ext</code>, <code>to_additive</code>.
It should collect almost all other attributes, e.g., <code>fun_prop</code>.</p><details id="instances-for-list-Mathlib.Command.MinImports.getAttrNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getAttrs"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L116-L125">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getAttrs" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAttrs"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAttrs</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">env</span> : <span class="fn">Lean.Environment</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">Lean.NameSet</span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAttrs">getAttrs</a> env stx</code> returns all attribute declaration names contained in <code>stx</code> and registered
in the <code>Environment</code> <code>env</code>.</p><details id="instances-for-list-Mathlib.Command.MinImports.getAttrs" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.previousInstName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L127-L143">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.previousInstName" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.previousInstName"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">previousInstName</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Name</span> â†’ <span class="fn">Lean.Name</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.previousInstName">previousInstName</a> nm</code> takes as input a name <code>nm</code>, assuming that it is the name of an
auto-generated &quot;nameless&quot; <code>instance</code>.
If <code>nm</code> ends in <code>..._n</code>, where <code>n</code> is a number, it returns the same name, but with <code>_n</code> replaced
by <code>_(n-1)</code>, unless <code>n â‰¤ 1</code>, in which case it simply removes the <code>_n</code> suffix.</p><details id="instances-for-list-Mathlib.Command.MinImports.previousInstName" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getDeclName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L145-L182">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getDeclName" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getDeclName"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getDeclName</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">cmd</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Lean.Name</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getDeclName">getDeclName</a> cmd id</code> takes a <code>Syntax</code> input <code>cmd</code> and returns the <code>Name</code> of the declaration defined
by <code>cmd</code>.</p><details id="instances-for-list-Mathlib.Command.MinImports.getDeclName" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getAllDependencies"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L184-L205">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getAllDependencies" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAllDependencies"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAllDependencies</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">cmd </span><span class="fn">id</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Lean.NameSet</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAllDependencies">getAllDependencies</a> cmd id</code> takes a <code>Syntax</code> input <code>cmd</code> and returns the <code>NameSet</code> of all the
declaration names that are implied by</p><ul><li>the <code>SyntaxNodeKinds</code>,</li><li>the attributes of <code>cmd</code> (if there are any),</li><li>the identifiers contained in <code>cmd</code>,</li><li>if <code>cmd</code> adds a declaration <code>d</code> to the environment, then also all the module names implied by <code>d</code>.
The argument <code>id</code> is expected to be an identifier.
It is used either for the internally generated name of a &quot;nameless&quot; <code>instance</code> or when parsing
an identifier representing the name of a declaration.</li></ul><p>Note that the return value does not contain dependencies of the dependencies;
you can use <code>Lean.NameSet.transitivelyUsedConstants</code> to get those.</p><details id="instances-for-list-Mathlib.Command.MinImports.getAllDependencies" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getAllImports"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L207-L232">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getAllImports" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAllImports"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getAllImports</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">cmd </span><span class="fn">id</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">dbg?</span> : <span class="fn">Bool</span> := <span class="fn">false</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Lean.NameSet</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getAllImports">getAllImports</a> cmd id</code> takes a <code>Syntax</code> input <code>cmd</code> and returns the <code>NameSet</code> of all the
module names that are implied by</p><ul><li>the <code>SyntaxNodeKinds</code>,</li><li>the attributes of <code>cmd</code> (if there are any),</li><li>the identifiers contained in <code>cmd</code>,</li><li>if <code>cmd</code> adds a declaration <code>d</code> to the environment, then also all the module names implied by <code>d</code>.
The argument <code>id</code> is expected to be an identifier.
It is used either for the internally generated name of a &quot;nameless&quot; <code>instance</code> or when parsing
an identifier representing the name of a declaration.</li></ul><details id="instances-for-list-Mathlib.Command.MinImports.getAllImports" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.getIrredundantImports"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L234-L239">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.getIrredundantImports" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getIrredundantImports"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">getIrredundantImports</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">env</span> : <span class="fn">Lean.Environment</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">importNames</span> : <span class="fn">Lean.NameSet</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">Lean.NameSet</span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.getIrredundantImports">getIrredundantImports</a> env importNames</code> takes an <code>Environment</code> and a <code>NameSet</code> as inputs.
Assuming that <code>importNames</code> are module names,
it returns the <code>NameSet</code> consisting of a minimal collection of module names whose transitive
closure is enough to parse (and elaborate) <code>cmd</code>.</p><details id="instances-for-list-Mathlib.Command.MinImports.getIrredundantImports" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.minImpsCore"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L241-L255">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.minImpsCore" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.minImpsCore"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">minImpsCore</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx </span><span class="fn">id</span> : <span class="fn">Lean.Syntax</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">Lean.Elab.Command.CommandElabM</span> <span class="fn">Unit</span></span></div></div><p><code><a href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.minImpsCore">minImpsCore</a> stx id</code> is the internal function to elaborate the <code>#min_imports in</code> command.
It collects the irredundant imports to parse and elaborate <code>stx</code> and logs</p><pre><code class="language-lean">import A
import B
...
import Z
</code></pre><p>The <code>id</code> input is expected to be the name of the declaration that is currently processed.
It is used to provide the internally generated name for &quot;nameless&quot; <code>instance</code>s.</p><details id="instances-for-list-Mathlib.Command.MinImports.minImpsCore" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.minImpsStx"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L257-L259">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.minImpsStx" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.minImpsStx"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">minImpsStx</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">Lean.ParserDescr</span></div></div><p><code>#min_imports in cmd</code> scans the syntax <code>cmd</code> and the declaration obtained by elaborating <code>cmd</code>
to find a collection of minimal imports that should be sufficient for <code>cmd</code> to work.</p><details id="instances-for-list-Mathlib.Command.MinImports.minImpsStx" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Command.MinImports.Â«command#min_importsIn_Â»"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/338973d7437af2cf5a6769391b1b4e5b1f8db099/Mathlib/Tactic/MinImports.lean#L261-L262">source</a></div><div class="verification_link">
<a href="../../../modules/Mathlib_Tactic_MinImports.html#Mathlib.Command.MinImports.Â«command#min_importsIn_Â»" class="verification-badge comp-operation" title="Computational operation (Bool/decidable)">ðŸ”¸ coverage</a>
</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/MinImports.html#Mathlib.Command.MinImports.Â«command#min_importsIn_Â»"><span class="name">Mathlib</span>.<span class="name">Command</span>.<span class="name">MinImports</span>.<span class="name">Â«command#min_importsIn_Â»</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">Lean.ParserDescr</span></div></div><p><code>#min_imports in cmd</code> scans the syntax <code>cmd</code> and the declaration obtained by elaborating <code>cmd</code>
to find a collection of minimal imports that should be sufficient for <code>cmd</code> to work.</p><details id="instances-for-list-Mathlib.Command.MinImports.Â«command#min_importsIn_Â»" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>